<!DOCTYPE html>
<html lang="pt-br">

<head>
    <!-- 05 – Após realizar o login considero um diferencial realizar a criação de um  usuário. A API para esse serviço está protegida por mecanismo para autenticação  baseada em token. 
URL: 
http://52.91.139.190/fsapi/users/auth/register-jwt
Método: 
POST 
JSON Exemplo 
{  
    "login": "fschorles@gmail.com", 
    "name": "Felipe Schorles", 
    "email":"fschorles@gmail.com", 
    "password": "123456", 
    "confirma_password": "123456", 
    "idEmpresa": "13", 
  "Status": "Aprovado", 
   "role" : "Client", 
   "regId": "", 
    "status" : "Aprovado" 
} 
Header: Token para autenticação no serviço. Pegar do retorno do login  realizado no desafio anterior 
Authorization = Bearer  
eyJhbGciOiJIUzI1NiJ9.eyJpZCI6IjVjNDYxMmM4ZGY3NWVkZmY0ZmJlNDlmZCJ9.gw8v8xd2XqhmBjG 83hw2JTncXsLg9n3bzo9sob_I5w4 -->
    
</head>

<body>
    <form name="Form">
        name:
        <input type="text" value="Felipe Schorles" name="name" /> <br><br>
        email:
        <input type="text" value="fschorles@gmail.com" name="email" /> <br><br>
        password:
        <input type="text" value="123456" name="password" /> <br><br>
        Token:
        <input type="text" value="eyJhbGciOiJIUzI1NiJ9.e30.dUGAzN9fAHIj40zxCKoSE6ADu5aNR4dX0D4qhZ5uMPE" id="mytoken" />
        <br><br>
        <button onclick="envio(event)">Enviar Formulario</button>
        <button><a href="index.html">Login</a></button>
    </form>
    <script>
        const envio = (e) => {
            e.preventDefault();

            var name = document.forms["Form"]["name"];
            var email = document.forms["Form"]["email"];
            var password = document.forms["Form"]["password"];
            var mytoken = document.forms["Form"]["mytoken"];

            var request = new XMLHttpRequest();

            request.onreadystatechange = () => {
                if (request.readyState == 4 && request.status == 200) {
                    const obj = JSON.parse(request.responseText);
                    if (obj.token) {
                        console.log(obj.token);
                        localStorage.setItem("token", obj.token);
                        document.getElementById("mytoken").innerHTML = obj.token;
                    }
                }
            };

            request.open("POST", "http://52.91.139.190/fsapi/users/auth/register-jwt");

            request.setRequestHeader("Content-type", "application/json");
            request.setRequestHeader("Authorization", "application/json");
            /* request.setRequestHeader("método GET ou POST", "url"); */

            request.send = JSON.stringify({
                "name": name.value,
                "email": email.value,
                "password": password.value,
                "token": mytoken.value
            })
            console.log(request.send);
        }
    </script>
</body>

</html>
